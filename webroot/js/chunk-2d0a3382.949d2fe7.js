(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0a3382"],{"00f2":function(t,a,e){"use strict";e.r(a);var s=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"chat-page"},[e("audio",{attrs:{id:"audioPlay",src:"/prompt.mp3"}}),e("nav",{staticClass:"navbar navbar-expand-lg navbar-light bg-light"},[e("div",{staticClass:"navbar-brand",on:{click:function(a){return t.$router.go(-1)}}},[e("i",{staticClass:"bi bi-backspace"}),t._v(" "+t._s(t.$route.params.username)+" "),e("i",{staticClass:"bi bi-person-fill"})]),t._m(0),e("div",{staticClass:"collapse navbar-collapse",attrs:{id:"navbarSupportedContent"}},[e("ul",{staticClass:"navbar-nav mr-auto"},[e("li",{staticClass:"nav-item"},[e("div",{staticClass:"nav-link",on:{click:t.del}},[t._v("删除好友")])]),e("li",{staticClass:"nav-item"},[e("div",{staticClass:"nav-link",on:{click:t.empty}},[t._v("清空聊天记录")])])])])]),e("div",{staticClass:"chat-list container"},t._l(t.chatList,(function(a){return e("div",{key:a.id,staticClass:"chat",class:{"chat-my":t.store.state.userName==a.UserName}},[e("div",{staticClass:"chat-userName"},[t._v(t._s(a.UserName))]),e("div",{staticClass:"chat-content alert alert-primary",class:{"alert-success":t.store.state.userName==a.UserName},attrs:{"data-container":"body","data-toggle":"popover","data-placement":"top","data-content":"Top popover"},on:{"!click":function(a){return t.chatClick.apply(null,arguments)}}},[e("div",{staticClass:"chat-text"},[t._v(" "+t._s(a.Data)+" ")]),e("div",[e("small",{attrs:{to:""}},[t._v(t._s(t.moment(a.CreatedAt,t.nowtime)))])])]),e("div",[e("small",[t._v(t._s(a.Ip))]),e("small",[t._v(" "+t._s(a.IpAddr))])])])})),0),e("div",{staticClass:"chat-send"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.text,expression:"text"}],staticClass:"chat-input",attrs:{type:"text"},domProps:{value:t.text},on:{keyup:function(a){return!a.type.indexOf("key")&&t._k(a.keyCode,"enter",13,a.key,"Enter")?null:t.send.apply(null,arguments)},input:function(a){a.target.composing||(t.text=a.target.value)}}}),e("button",{staticClass:"btn btn-dark",attrs:{type:"button"},on:{click:t.send}},[t._v("send")])])])},n=[function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("button",{staticClass:"navbar-toggler",attrs:{type:"button","data-toggle":"collapse","data-target":"#navbarSupportedContent","aria-controls":"navbarSupportedContent","aria-expanded":"false","aria-label":"Toggle navigation"}},[e("span",{staticClass:"navbar-toggler-icon"})])}],i=(e("ac1f"),e("5319"),e("c0d6")),r=e("c1df"),o=e.n(r),c={name:"SessionUser",data:function(){return{store:i["a"],target:this.$route.params["username"],chatList:[],text:"",nowtime:new Date}},created:function(){var t=this;this.loadData((function(){t.$nextTick((function(){this.chatListToEnd()}))}));var a=this;this.timer=setInterval((function(){a.nowtime=new Date}),1e4),this.store.e.on("friends",(function(a){a.UserName!=t.target&&a.Target!=t.target||(t.chatList.push(a),t.chatListIsEnd()&&t.$nextTick((function(){this.chatListToEnd()})))}))},beforeDestroy:function(){console.log("销毁"),clearInterval(this.timer)},methods:{loadData:function(t){var a=this;i["a"].http.get("/api/get_friendschat/"+this.target).then((function(e){a.chatList=e.data.list,t&&t()}))},send:function(){i["a"].send({type:"friends",target:this.target,txt:this.text}),this.text="",this.chatListToEnd()},chatClick:function(t,a,e,s){console.log(t,this)},moment:function(t,a){return o()(t).fromNow()},chatListToEnd:function(){var t=this.$el.querySelector(".chat-list");t.scrollTop=t.scrollHeight},chatListIsEnd:function(){var t=this.$el.querySelector(".chat-list"),a=t.clientHeight+t.scrollTop;return a>=t.scrollHeight},logout:function(){localStorage.userName=localStorage.toKen="",i["a"].router.replace("/"),location.reload()},empty:function(){var t=this;i["a"].http.post("/api/del_friendschat/"+this.target).then((function(a){t.loadData()}))},del:function(){var t=this;i["a"].http.post("/api/del_friends/"+this.target).then((function(a){t.$router.go(-1)}))}}},l=c,u=e("2877"),d=Object(u["a"])(l,s,n,!1,null,"07eefe8a",null);a["default"]=d.exports}}]);
//# sourceMappingURL=chunk-2d0a3382.949d2fe7.js.map